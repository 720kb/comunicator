{"version":3,"sources":["send-to.js"],"names":[],"mappings":";;;;;;;;;;;;;AACA,IAAA,KAAA,QAAA,IAAA,CAAA;IACA,QAAA,QAAA,OAAA,EAAA,gCAAA,CAAA;;AAEA,OAAA,OAAA,GAAA;mCAAA;+DAAA,IAAA,GAAA;mCAAA;kEAAA,IAAA,GAAA;SAAA;AACA,cAAA,gBAAA,MAAA,EAAA,GAAA,EAAA,IAAA,EAAA;;AAEA,UAAA,CAAA,MAAA,IACA,CAAA,GAAA,IACA,CAAA,IAAA,EAAA;;AAEA,cAAA,IAAA,KAAA,kDAAA,iBAAA,cAAA,IAAA,CAAA,CAFA;OAFA,MAKA;;AAEA,YAAA,SAAA;AACA,oBAAA,OAAA;AACA,wBAFA;AAGA,kBAHA;AAIA,oBAJA;SAAA;YAMA,aAAA,iBAAA,GAAA,CAAA,GAAA,CAAA,CARA;;AAUA,wCAAA,kBAAA,gBAAA,oBAAA,IAAA,EAVA;AAWA,YAAA,QAAA,UAAA,KACA,WAAA,UAAA,KAAA,GAAA,IAAA,EAAA;;AAEA,qBAAA,IAAA,CAAA,KAAA,SAAA,CAAA,MAAA,CAAA,EAFA;SADA,MAIA;;AAEA,cAAA,CAAA,oBAAA,GAAA,CAAA,GAAA,CAAA,EAAA;;AAEA,gCAAA,GAAA,CAAA,GAAA,EAAA,EAAA,EAFA;WAAA;;AAKA,8BAAA,GAAA,CAAA,GAAA,EAAA,IAAA,CAAA;AACA,0BADA;AAEA,oBAFA;AAGA,sBAHA;WAAA,EAPA;AAYA,0BAAA,qCAAA,EAZA;SAJA;OAhBA;KAFA;;CADA","file":"send-to.js","sourcesContent":["/**\n* comunicator\n* 2.2.4\n*\n* The 720kb notifier api (atm it uses websockets)\n* https://github.com/720kb/comunicator\n*\n* MIT license\n* Thu Feb 25 2016\n*/\n/*global require,module*/\nconst ws = require('ws')\n  , debug = require('debug')('720kb:comunicator:sender:debug');\n\nmodule.exports = ({connectedSockets = new Map(), sendPendingRequests = new Map()}) => ({\n  'sendTo': (whoami, who, what) => {\n\n    if (!whoami &&\n      !who &&\n      !what) {\n\n      throw new Error(`Mandatory params [whoami] - [who] - [what]: ${whoami} - ${who} - ${what}`);\n    } else {\n\n      const toSend = {\n          'opcode': 'to-me',\n          whoami,\n          who,\n          what\n        }\n        , aWebSocket = connectedSockets.get(who);\n\n      debug(`Sending message from ${whoami} to ${who} via ${aWebSocket}: ${what}`);\n      if (Boolean(aWebSocket) &&\n        aWebSocket.readyState === ws.OPEN) {\n\n        aWebSocket.send(JSON.stringify(toSend));\n      } else {\n\n        if (!sendPendingRequests.has(who)) {\n\n          sendPendingRequests.set(who, []);\n        }\n\n        sendPendingRequests.get(who).push({\n          whoami,\n          who,\n          what\n        });\n        debug(`User ${who} isn't here at the moment...`);\n      }\n    }\n  }\n});\n"],"sourceRoot":"/source/"}