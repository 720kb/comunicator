{"version":3,"file":"comunicator-angular.min.js","sources":["../src/js/raf.js","../src/js/comunicator.js","../src/angular/comunicator.js"],"names":["window","lastTime","vendors","x","length","requestAnimationFrame","cancelAnimationFrame","callback","currTime","Date","getTime","timeToCall","Math","max","id","setTimeout","clearTimeout","Comunicator","url","_onTick","redoFunction","type","requestId","nextTimeWaitSliceChoice","this","chosenTimeWaitValue","websocket","readyState","WebSocket","OPEN","bind","sendPendingRequests","push","joinPendingRequests","timeWaitSlice","pow","timeWaitSliceChoices","giveMeATimeWait","floor","random","_doJoin","joinPendingRequestsLength","aPendingRequest","onTickBoundedOnDoJoin","joinPendingRequestsIndex","JSON","stringify","opcode","whoami","whoReallyAmI","token","reallyToken","CONNECTING","initComunicator","send","sendMessage","onmessage","onWebsocketMessage","onclose","onWebsocketClose","event","eventToDispatch","parsedMsg","parse","data","CustomEvent","detail","dispatchEvent","sendPendingRequestsLength","onTickBoundedOnSend","sendPendingRequestsIndex","websocketUrl","onopen","console","info","prototype","promise","events","Array","isArray","deferred","resolve","eventsToListenIndex","anEventToListen","eventsToListenLength","userIsPresent","broadcast","what","toSend","who","sendTo","doClose","close","resolveComunicator","removeEventListener","exit","addEventListener","Promise","angular","module","provider","comunicator","setComunicatorServerURL","$get","$rootScope","$window","$log","arrivedJoined","$apply","scope","$emit","debug","arrivedToMe","arrivedToAll","arrivedClosed","eventsToListen","domEvent","unregisterListeners","unregisterListenersIndex","unregisterListenersLength","kickOffEvent","Event","$on"],"mappings":"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"}