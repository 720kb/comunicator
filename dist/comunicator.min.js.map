{"version":3,"file":"comunicator.min.js","sources":["../src/js/comunicator.js"],"names":["window","Comunicator","url","_onTick","redoFunction","type","requestId","nextTimeWaitSliceChoice","this","chosenTimeWaitValue","websocket","readyState","WebSocket","OPEN","requestAnimationFrame","bind","sendPendingRequests","push","joinPendingRequests","timeWaitSlice","Math","pow","timeWaitSliceChoices","length","giveMeATimeWait","floor","random","_doJoin","joinPendingRequestsLength","aPendingRequest","onTickBoundedOnDoJoin","joinPendingRequestsIndex","JSON","stringify","opcode","whoami","whoReallyAmI","token","reallyToken","cancelAnimationFrame","CONNECTING","initComunicator","send","sendMessage","onmessage","onWebsocketMessage","onclose","onWebsocketClose","event","eventToDispatch","parsedMsg","parse","data","CustomEvent","detail","dispatchEvent","sendPendingRequestsLength","onTickBoundedOnSend","sendPendingRequestsIndex","websocketUrl","onopen","console","info","prototype","promise","events","Array","isArray","deferred","resolve","eventsToListenIndex","anEventToListen","eventsToListenLength","userIsPresent","broadcast","what","toSend","who","sendTo","doClose","close","resolveComunicator","removeEventListener","exit","addEventListener","Promise"],"mappings":"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"}